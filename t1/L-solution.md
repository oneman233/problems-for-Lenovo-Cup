首先要发现这样一个事实：**对于某一层来说，合法的方案数与斐波那契数同阶**

由于墙的宽度很小，所以可以dfs找出合法的方案，你很快就能发现方案数最多也就 $120$ 种

接下来用最多 $O(120^2\times w)$ 的时间可以处理出**任意两种方案能否放在相邻层**

我们维护一个矩阵 $ok[i][j]$，如果 $i$ 方案和 $j$ 方案能够相邻，那么我们标记 $ok[i][j]=1$，否则 $ok[i][j]=0$

同时也不难发现 $ok[i][j]=ok[j][i]$

现在仔细想想你获得了什么？这个 $120 \times 120$ 的矩阵可以被理解为一张巨大的无向图，总的砌墙合法方案数就是：**以任意两个点做为起点和终点，在无向图上经过 $h$ 步之后的方案数之和**

这是矩阵快速幂的经典应用，总的时间复杂度为：$O(120^3\times log(10^9))$

这道题idea来自网易雷火去年的笔试题，原题只有长度 $2$ 和 $3$ 两种砖，并且宽度 $\leq 30$，高度 $\leq 10$，原题的第一步与本题差不多，但是无法用矩阵快速幂求解，因为合法方案数可能会大于 $10^3$，但是原题的高度非常小，所以可以在有向图上暴力dfs来统计答案